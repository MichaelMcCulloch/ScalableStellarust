- name: Install Nginx Ingress
  register: installNginxIngressChart
  shell: >
    helm install \
      ingress-nginx ingress-nginx/ingress-nginx \
      --namespace ingress-nginx \
      --create-namespace
  failed_when:
    - '"Error: INSTALLATION FAILED: cannot re-use a name that is still in use" not in installNginxIngressChart.stderr'
    - '"The ingress-nginx controller has been installed." not in installNginxIngressChart.stdout'
# - name: Install Nginx Ingress with kubectl
#   register: installNginxIngressChart
#   shell: >
#     kubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/main/deploy/static/provider/cloud/deploy.yaml
